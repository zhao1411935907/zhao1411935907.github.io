<!DOCTYPE html>
<html lang="en" xmlns:mso="urn:schemas-microsoft-com:office:office" xmlns:msdt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882">

<head>
    <meta charset="utf-8">
    <title>Plant Suitability for Dryland Agro-Ecosystems</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <meta content="" name="keywords">
    <meta content="" name="description">

    <!-- Favicon -->
    <link href="{{ url_for('static', filename='img/logo.png') }}" rel="icon">

    <!-- Google Web Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Jost:wght@500;600;700&family=Open+Sans:wght@400;500&display=swap" rel="stylesheet">  

    <!-- Icon Font Stylesheet -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <script src="https://kit.fontawesome.com/7b95f0d15f.js" crossorigin="anonymous"></script>
    
    <!-- Libraries Stylesheet -->
    <link href="static/lib/animate/animate.min.css" rel="stylesheet">
    <link href="static/lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">
    <link href="static/lib/lightbox/css/lightbox.min.css" rel="stylesheet">

    <!-- Customized Bootstrap Stylesheet -->
    <link href="{{ url_for('static', filename='css/bootstrap.min.css') }}" rel="stylesheet">

    <!-- Template Stylesheet -->
    <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet">


<!--[if gte mso 9]><xml>
<mso:CustomDocumentProperties>
<mso:xd_Signature msdt:dt="string"></mso:xd_Signature>
<mso:display_urn_x003a_schemas-microsoft-com_x003a_office_x003a_office_x0023_Editor msdt:dt="string">Gao, Dian</mso:display_urn_x003a_schemas-microsoft-com_x003a_office_x003a_office_x0023_Editor>
<mso:Order msdt:dt="string">18903200.0000000</mso:Order>
<mso:xd_ProgID msdt:dt="string"></mso:xd_ProgID>
<mso:_ExtendedDescription msdt:dt="string"></mso:_ExtendedDescription>
<mso:SharedWithUsers msdt:dt="string"></mso:SharedWithUsers>
<mso:display_urn_x003a_schemas-microsoft-com_x003a_office_x003a_office_x0023_Author msdt:dt="string">Gao, Dian</mso:display_urn_x003a_schemas-microsoft-com_x003a_office_x003a_office_x0023_Author>
<mso:ComplianceAssetId msdt:dt="string"></mso:ComplianceAssetId>
<mso:TemplateUrl msdt:dt="string"></mso:TemplateUrl>
<mso:ContentTypeId msdt:dt="string">0x0101002F762B7C5F8C1B44A969538F1EBF5320</mso:ContentTypeId>
<mso:TriggerFlowInfo msdt:dt="string"></mso:TriggerFlowInfo>
<mso:_SourceUrl msdt:dt="string"></mso:_SourceUrl>
<mso:_SharedFileIndex msdt:dt="string"></mso:_SharedFileIndex>
<mso:MediaLengthInSeconds msdt:dt="string"></mso:MediaLengthInSeconds>
<mso:TaxCatchAll msdt:dt="string"></mso:TaxCatchAll>
<mso:MediaServiceImageTags msdt:dt="string"></mso:MediaServiceImageTags>
<mso:lcf76f155ced4ddcb4097134ff3c332f msdt:dt="string"></mso:lcf76f155ced4ddcb4097134ff3c332f>
</mso:CustomDocumentProperties>
</xml><![endif]-->
</head>

<body>
    <!-- Navbar Start -->
    <nav class="navbar navbar-expand-lg bg-white navbar-light sticky-top p-0">
        <a href="{{ url_for('main.homepage') }}" class="navbar-brand d-flex align-items-center px-4 px-lg-5">
            <img src="{{ url_for('static', filename='img/logo.png') }}" alt="LOGO" style="height: 100px; margin-right: 10px;">
            <h1 class="m-0" style="font-size: 24px;">Plant Suitability for Dryland Agro-Ecosystems</h1>
        </a>
        <button type="button" class="navbar-toggler me-4" data-bs-toggle="collapse" data-bs-target="#navbarCollapse">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarCollapse">
            <div class="navbar-nav ms-auto p-4 p-lg-0 d-flex align-items-center">
                
                <!-- Search form before Home link -->
                <form action="{{ url_for('main.search') }}" method="get" class="d-flex" style="max-width: 500px; margin-right: 50px;">
                    <input type="text" id="searchQuery" class="form-control" placeholder="Search plants" name="searchQuery" style="width: 100%; height: 100%;">
                    <button class="btn btn-primary ms-2" type="submit" style="height: 100%;">Search</button>
                </form>
            <!-- Home Icon -->
            <a href="{{ url_for('main.homepage') }}" class="nav-item nav-link">
                <i class="fas fa-home"></i>
            </a>
                
            <!-- Filter Page Icon -->
            <a href="{{ url_for('main.home') }}" class="nav-item nav-link">
                <i class="fas fa-filter"></i>
            </a>

            <!-- Dashboard Icon (Admin or User) -->
            {% if session.get('admin_logged_in') %}
                <a href="{{ url_for('admin.admin_dashboard') }}" class="nav-item nav-link">
                    <i class="fas fa-user-alt"></i>
                </a>
                <a href="{{ url_for('user.logout') }}" class="nav-item nav-link">Logout</a>
            {% elif session.get('user_logged_in') %}
                <a href="{{ url_for('user.user_dashboard') }}" class="nav-item nav-link">
                    <i class="fas fa-user"></i>
                </a>
                <a href="{{ url_for('user.logout') }}" class="nav-item nav-link">Logout</a>
            {% else %}
                <a href="{{ url_for('user.login') }}" class="nav-item nav-link">Login</a>
            {% endif %}
            </div>
        </div>
        
    </nav>
    <!-- Navbar End -->
    <div class="container-xxl py-5">
        <a href="#" onclick="window.history.back(); return false;" class="back-to-search">
            <i class="bi bi-backspace"></i> Back
        </a>
    </div>
    <!-- Flash Messages Area -->
    <div class="container mt-3">
      {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
              {% for category, message in messages %}
                  <div class="alert alert-{{ category }} alert-dismissible fade show" role="alert">
                      {{ message }}
                  </div>
              {% endfor %}
          {% endif %}
      {% endwith %} 
    </div>


    {% block content %}
    {% endblock %}

    <!-- Spinner Start -->
    <div id="spinner" class="show bg-white position-fixed translate-middle w-100 vh-100 top-50 start-50 d-flex align-items-center justify-content-center">
        <div class="spinner-border text-primary" role="status" style="width: 3rem; height: 3rem;"></div>
    </div>
    <!-- Spinner End -->

<!-- Search form at the bottom -->
<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-8">
            <form action="{{ url_for('main.search') }}" method="get">
                <div class="input-group mb-3">
                    <input type="text" id="searchQueryBottom" class="form-control" placeholder="Search plants" name="searchQuery">
                    <button class="btn btn-primary" type="submit">Search</button>
                </div>
            </form>
        </div>
    </div>
</div>



  <!-- Back to Top -->
  <a href="#" class="btn btn-lg btn-primary btn-lg-square rounded-circle back-to-top"><i class="bi bi-arrow-up"></i></a>

  <!-- JavaScript Libraries -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://code.jquery.com/ui/1.13.1/jquery-ui.min.js"></script>
  <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">

  <!-- -----------------------------search suggestions----------------------------------------------->
  <script>
    $(document).ready(function() {
        $("#searchQuery").autocomplete({
            source: "{{ url_for('main.search_suggestions') }}",
            minLength: 2,
            html: true,  
            open: function(event, ui) {
                $(".ui-autocomplete").css("z-index", 1000);
            },
            select: function(event, ui) {
                $(this).val(ui.item.value);
                return false; 
            },
            create: function () {
                $(this).data('ui-autocomplete')._renderItem = function (ul, item) {
                    return $("<li class='ui-autocomplete-row'></li>")
                        .data("item.autocomplete", item)
                        .append(`<div style='font-weight: bold;'>${item.label}</div>`)
                        .appendTo(ul);
                };
            }
        }).autocomplete("instance")._renderItem = function(ul, item) {
            return $("<li class='ui-autocomplete-row'>")
                .append(`<div style='font-weight:bold; color: #007BFF;'>${item.label.split('<br>')[0]}</div><div class='common-name'>${item.label.split('<br>')[1]}</div>`)
                .appendTo(ul);
        };
    });
    </script>

<!-- -----------------------------fill in all required fields----------------------------------------------->
<script>
    document.addEventListener("DOMContentLoaded", function() {
      document.getElementById("submitBtn").addEventListener("click", function(event) {
        var inputs = document.querySelectorAll("input[required]");
        var isValid = true;
        inputs.forEach(function(input) {
          if (!input.value.trim()) {
            isValid = false;
            input.classList.add("is-invalid");
          } else {
            input.classList.remove("is-invalid");
          }
        });
        if (!isValid) {
          event.preventDefault();
          
          alert("Please fill in all required fields.");
        }
      });
    });
  </script>  

  <!-- -----------------------------cookies for saving the weight value----------------------------------------------->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
        var form = document.querySelector('form[action="/final_scores"]');
        if (form) {
            form.addEventListener('submit', function() {
                var inputs = document.querySelectorAll('input[type="range"]');
                inputs.forEach(function(input) {
                    var key = input.name;
                    var value = input.value;
                    document.cookie = key + "=" + value + ";path=/;max-age=" + (60 * 60 * 24 * 30); // save for 30 days
                });
            });
        }
    });
    </script>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            var inputs = document.querySelectorAll('input[type="range"]');
            var filterData = "{{ filter|tojson|safe if filter is defined else '{}' }}";

            inputs.forEach(function(input) {
                var key = input.name;
                var filterValue = filterData[key]; 
                var cookieValue = getCookie(key);  
                
                if (filterValue) {
                    input.value = filterValue;
                    input.nextElementSibling.value = filterValue;
                    document.cookie = key + "=" + filterValue + ";path=/;max-age=" + (60 * 60 * 24 * 30); 
                } else if (cookieValue) {
                    input.value = cookieValue;
                    input.nextElementSibling.value = cookieValue;
                }
            });

            function getCookie(name) {
                var nameEQ = name + "=";
                var ca = document.cookie.split(';');
                for (var i = 0; i < ca.length; i++) {
                    var c = ca[i];
                    while (c.charAt(0) == ' ') c = c.substring(1, c.length);
                    if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);
                }
                return null;
            }
        });
    </script>



<script>
    document.getElementById('Image').addEventListener('change', function() {
        var submitBtn = document.getElementById('submit-btn');
        var cancelBtn = document.getElementById('cancel-btn');

        if (this.files && this.files.length > 0) {
            submitBtn.style.display = 'inline-block';
            cancelBtn.style.display = 'inline-block';
        } else {
            submitBtn.style.display = 'none';
            cancelBtn.style.display = 'none';
        }
    });

    document.getElementById('cancel-btn').addEventListener('click', function() {
        var imageInput = document.getElementById('Image');
        var submitBtn = document.getElementById('submit-btn');
        var cancelBtn = document.getElementById('cancel-btn');

        imageInput.value = ''; // Clear the file input
        submitBtn.style.display = 'none';
        cancelBtn.style.display = 'none';
    });
</script>


  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="{{ url_for('static', filename='lib/wow/wow.min.js') }}"></script>

  <script src="{{url_for('static', filename='lib/easing/easing.min.js')}}"></script>

  <script src="{{url_for('static', filename='lib/waypoints/waypoints.min.js')}}"></script>

  <script src="{{url_for('static', filename='lib/owlcarousel/owl.carousel.min.js')}}"></script>

  <script src="{{url_for('static', filename='lib/counterup/counterup.min.js')}}"></script>

  <script src="{{url_for('static', filename='lib/parallax/parallax.min.js')}}"></script>

  <script src="{{url_for('static', filename='lib/isotope/isotope.pkgd.min.js')}}"></script>

  <script src="{{url_for('static', filename='lib/lightbox/js/lightbox.min.js')}}"></script>

  <!-- Template Javascript -->
  <script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>

</html>